<!DOCTYPE HTML>

<html>

<head>
    <style>
        body{
            background-color: darkolivegreen;
        }
    </style>
    <script type="text/javascript">

        var setr = [0, 0];
        var gamepad_conncted = true;

        function suk() {
            setr = [0, 0];

            //get gamewpad axes
            if (gamepad_conncted) {
                var gamepads = navigator.getGamepads ? navigator.getGamepads() : (navigator.webkitGetGamepads ? navigator.webkitGetGamepads : []);
                var gp = gamepads[0];
                if (gp) {
                    //gamepadInfo.innerHTML = "Gamepad connected at index " + gp.index + ": " + gp.id +". It has " + gp.buttons.length + " buttons and " + gp.axes.length + " axes.";
                    var motor1 = -parseInt(gp.axes[1] * 255);
                    var motor2 = -parseInt(gp.axes[3] * 255);
                    setr[0] = motor1;
                    setr[1] = motor2;
                }
            }
            ws.send(setr);
        }

        // Let us open a web socket
        var ws = new WebSocket("ws://localhost:8765/ws");

        ws.onopen = function () {
            // Web Socket is connected, send data using send()
            ws.send("connected, starting control");

            setInterval(suk, 100);
        };

        ws.onmessage = function (evt) {
            var received_msg = evt.data;
            console.log("received: " + received_msg);
        };

        ws.onclose = function () {
            alert("Connection is closed...");
        };
    </script>

</head>

<body>
</body>

</html>

